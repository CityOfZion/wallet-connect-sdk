<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@cityofzion/wallet-connect-sdk-core</title><meta name="description" content="Documentation for @cityofzion/wallet-connect-sdk-core"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">@cityofzion/wallet-connect-sdk-core</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><h1>@cityofzion/wallet-connect-sdk-core</h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography">
<a href="#wcsdk-core" id="wcsdk-core" style="color: inherit; text-decoration: none;">
  <h1>WcSdk CORE</h1>
</a>

<a href="#installation" id="installation" style="color: inherit; text-decoration: none;">
  <h2>Installation</h2>
</a>
<p>Install the dependency on your client-side application:</p>
<pre><code><span class="hl-2">npm</span><span class="hl-0"> </span><span class="hl-2">i</span><span class="hl-0"> @</span><span class="hl-2">cityofzion</span><span class="hl-0">/</span><span class="hl-2">wallet</span><span class="hl-0">-</span><span class="hl-2">connect</span><span class="hl-0">-</span><span class="hl-2">sdk</span><span class="hl-0">-</span><span class="hl-2">core</span><span class="hl-0"> @</span><span class="hl-2">walletconnect</span><span class="hl-0">/</span><span class="hl-2">client</span><span class="hl-0">@</span><span class="hl-4">2.0</span><span class="hl-0">.</span><span class="hl-4">0</span><span class="hl-0">-</span><span class="hl-2">beta</span><span class="hl-0">.</span><span class="hl-4">17</span><span class="hl-0"> @</span><span class="hl-2">walletconnect</span><span class="hl-0">/</span><span class="hl-2">qrcode</span><span class="hl-0">-</span><span class="hl-2">modal</span><span class="hl-3">&quot;@2.0.0-alpha.20 @walletconnect/types@2.0.0-beta.17 @walletconnect/utils@2.0.0-beta.1</span><span class="hl-5">7</span>
</code></pre>
<p><small><small>(Or, idk... do your yarn thing ðŸ˜…)</small></small></p>

<a href="#setup" id="setup" style="color: inherit; text-decoration: none;">
  <h2>Setup</h2>
</a>
<p>Wrap WalletConnectContextProvider around your App by passing an options object as prop:</p>
<pre><code class="language-jsx"><span class="hl-6">import</span><span class="hl-0"> {</span><span class="hl-2">WcSdk</span><span class="hl-0">} </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-3">&quot;@cityofzion/wallet-connect-sdk-core&quot;</span><span class="hl-0">;</span><br/><br/><span class="hl-7">const</span><span class="hl-0"> </span><span class="hl-8">wcClient</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-2">WcSdk</span><span class="hl-0">.</span><span class="hl-9">initClient</span><span class="hl-0">(</span><br/><span class="hl-0">  </span><span class="hl-3">&quot;debug&quot;</span><span class="hl-0">, </span><span class="hl-10">// logger: use debug to show all log information on browser console</span><br/><span class="hl-0">  </span><span class="hl-3">&quot;wss://relay.walletconnect.org&quot;</span><span class="hl-0"> </span><span class="hl-10">// we are using walletconnect&#39;s official relay server</span><br/><span class="hl-0">);</span>
</code></pre>

<a href="#recipes" id="recipes" style="color: inherit; text-decoration: none;">
  <h2>Recipes</h2>
</a>

<a href="#check-if-the-user-has-a-session-and-get-its-accounts" id="check-if-the-user-has-a-session-and-get-its-accounts" style="color: inherit; text-decoration: none;">
  <h3>Check if the user has a Session and get its Accounts</h3>
</a>
<pre><code class="language-js"><span class="hl-7">const</span><span class="hl-0"> </span><span class="hl-8">session</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-2">WcSdk</span><span class="hl-0">.</span><span class="hl-9">getSession</span><span class="hl-0">(</span><span class="hl-2">wcClient</span><span class="hl-0">);</span><br/><br/><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-2">session</span><span class="hl-0">) {</span><br/><span class="hl-0">  </span><span class="hl-2">console</span><span class="hl-0">.</span><span class="hl-9">log</span><span class="hl-0">(</span><span class="hl-2">WcSdk</span><span class="hl-0">.</span><span class="hl-9">getAccountAddress</span><span class="hl-0">(</span><span class="hl-2">session</span><span class="hl-0">)) </span><span class="hl-10">// print the account address</span><br/><span class="hl-0">  </span><span class="hl-2">console</span><span class="hl-0">.</span><span class="hl-9">log</span><span class="hl-0">(</span><span class="hl-2">session</span><span class="hl-0">.</span><span class="hl-2">state</span><span class="hl-0">.</span><span class="hl-2">accounts</span><span class="hl-0">); </span><span class="hl-10">// print the accounts (with the chain info)</span><br/><span class="hl-0">  </span><span class="hl-2">console</span><span class="hl-0">.</span><span class="hl-9">log</span><span class="hl-0">(</span><span class="hl-2">session</span><span class="hl-0">.</span><span class="hl-2">peer</span><span class="hl-0">.</span><span class="hl-2">metadata</span><span class="hl-0">); </span><span class="hl-10">// print the wallet metadata </span><br/><span class="hl-0">}</span>
</code></pre>

<a href="#connect-to-the-wallet" id="connect-to-the-wallet" style="color: inherit; text-decoration: none;">
  <h3>Connect to the Wallet</h3>
</a>
<pre><code class="language-js"><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-2">SessionTypes</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-3">&#39;@walletconnect/types&#39;</span><br/><span class="hl-6">import</span><span class="hl-0"> </span><span class="hl-2">Client</span><span class="hl-0"> </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-3">&#39;@walletconnect/client&#39;</span><br/><span class="hl-6">import</span><span class="hl-0"> </span><span class="hl-2">QRCodeModal</span><span class="hl-0"> </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-3">&#39;@walletconnect/qrcode-modal&#39;</span><br/><br/><span class="hl-2">WcSdk</span><span class="hl-0">.</span><span class="hl-9">subscribeToEvents</span><span class="hl-0">(</span><span class="hl-2">wcClient</span><span class="hl-0">, {</span><br/><span class="hl-0">  </span><span class="hl-9">onProposal</span><span class="hl-2">:</span><span class="hl-0"> </span><span class="hl-2">uri</span><span class="hl-0"> </span><span class="hl-7">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-2">QRCodeModal</span><span class="hl-0">.</span><span class="hl-9">open</span><span class="hl-0">(</span><span class="hl-2">uri</span><span class="hl-0">, () </span><span class="hl-7">=&gt;</span><span class="hl-0"> { </span><span class="hl-10">/* nothing */</span><span class="hl-0"> })</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-2">WcSdk</span><span class="hl-0">.</span><span class="hl-9">connect</span><span class="hl-0">(</span><span class="hl-2">wcClient</span><span class="hl-0">, {</span><br/><span class="hl-0">  </span><span class="hl-2">chainId:</span><span class="hl-0"> </span><span class="hl-3">&quot;neo3:testnet&quot;</span><span class="hl-0">, </span><span class="hl-10">// blockchain and network identifier</span><br/><span class="hl-0">  </span><span class="hl-2">methods:</span><span class="hl-0"> [</span><span class="hl-3">&quot;invokefunction&quot;</span><span class="hl-0">], </span><span class="hl-10">// which RPC methods do you plan to call</span><br/><span class="hl-0">  </span><span class="hl-2">appMetadata:</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-2">name:</span><span class="hl-0"> </span><span class="hl-3">&quot;MyApplicationName&quot;</span><span class="hl-0">, </span><span class="hl-10">// your application name to be displayed on the wallet</span><br/><span class="hl-0">    </span><span class="hl-2">description:</span><span class="hl-0"> </span><span class="hl-3">&quot;My Application description&quot;</span><span class="hl-0">, </span><span class="hl-10">// description to be shown on the wallet</span><br/><span class="hl-0">    </span><span class="hl-2">url:</span><span class="hl-0"> </span><span class="hl-3">&quot;https://myapplicationdescription.app/&quot;</span><span class="hl-0">, </span><span class="hl-10">// url to be linked on the wallet</span><br/><span class="hl-0">    </span><span class="hl-2">icons:</span><span class="hl-0"> [</span><span class="hl-3">&quot;https://myapplicationdescription.app/myappicon.png&quot;</span><span class="hl-0">], </span><span class="hl-10">// icon to be shown on the wallet</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">})</span>
</code></pre>

<a href="#disconnect" id="disconnect" style="color: inherit; text-decoration: none;">
  <h3>Disconnect</h3>
</a>
<pre><code class="language-js"><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-2">WcSdk</span><span class="hl-0">.</span><span class="hl-9">disconnect</span><span class="hl-0">(</span><span class="hl-2">wcClient</span><span class="hl-0">, </span><span class="hl-2">session</span><span class="hl-0">);</span>
</code></pre>

<a href="#make-an-json-rpc-call" id="make-an-json-rpc-call" style="color: inherit; text-decoration: none;">
  <h3>Make an JSON-RPC call</h3>
</a>
<p>Every request is made via JSON-RPC. You need to provide a method name that is expected by the wallet and listed on
the <code>methods</code> property of the <a href="#setup">options object</a> as well as some additional <code>parameters</code>.</p>
<p>The JSON-RPC format accepts parameters in many formats. The rules on how to construct this request will depend
entirely on the blockchain you are using. The code below is an example of a request constructed for the Neo Blockchain:</p>
<pre><code class="language-js"><span class="hl-7">const</span><span class="hl-0"> </span><span class="hl-8">chainId</span><span class="hl-0"> = </span><span class="hl-3">&quot;neo3:testnet&quot;</span><span class="hl-0">; </span><span class="hl-10">// blockchain and network identifier</span><br/><span class="hl-7">const</span><span class="hl-0"> </span><span class="hl-8">resp</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-2">WcSdk</span><span class="hl-0">.</span><span class="hl-9">sendRequest</span><span class="hl-0">(</span><span class="hl-2">wcClient</span><span class="hl-0">, </span><span class="hl-2">session</span><span class="hl-0">, </span><span class="hl-2">chainId</span><span class="hl-0">, {</span><br/><span class="hl-0">  </span><span class="hl-2">method:</span><span class="hl-0"> </span><span class="hl-3">&#39;rpcMethod&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-2">params:</span><span class="hl-0"> [</span><span class="hl-3">&#39;param&#39;</span><span class="hl-0">, </span><span class="hl-4">3</span><span class="hl-0">, </span><span class="hl-7">true</span><span class="hl-0">]</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-10">// the response format depends interely on the blockchain response format</span><br/><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-2">resp</span><span class="hl-0">.</span><span class="hl-2">result</span><span class="hl-0">.</span><span class="hl-2">error</span><span class="hl-0"> &amp;&amp; </span><span class="hl-2">resp</span><span class="hl-0">.</span><span class="hl-2">result</span><span class="hl-0">.</span><span class="hl-2">error</span><span class="hl-0">.</span><span class="hl-2">message</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-2">window</span><span class="hl-0">.</span><span class="hl-9">alert</span><span class="hl-0">(</span><span class="hl-2">resp</span><span class="hl-0">.</span><span class="hl-2">result</span><span class="hl-0">.</span><span class="hl-2">error</span><span class="hl-0">.</span><span class="hl-2">message</span><span class="hl-0">);</span><br/><span class="hl-0">}</span>
</code></pre>

<a href="#invoking-a-smartcontract-method-on-neo-blockchain" id="invoking-a-smartcontract-method-on-neo-blockchain" style="color: inherit; text-decoration: none;">
  <h3>Invoking a SmartContract method on Neo Blockchain</h3>
</a>
<p>To invoke a SmartContract method you can use <code>WcSdk.sendRequest</code> with <code>invokeFunction</code> as method, but WcSdk
has a shortcut: <code>WcSdk.invokeFunction</code>.</p>
<p>On the example below we are invoking the <code>transfer</code> method of the <code>GAS</code> token. Neo blockchain expect params with
<code>{ type, value }</code> format, and on <code>type</code> you should provide one of the types mentioned
<a href="https://github.com/neo-project/neo/blob/master/src/neo/SmartContract/ContractParameterType.cs">here</a>.
WcSdk has some special types to facilitate: <code>Address</code> and <code>ScriptHash</code>.</p>
<p>Check it out:</p>
<pre><code class="language-js"><span class="hl-7">const</span><span class="hl-0"> </span><span class="hl-8">scripthash</span><span class="hl-0"> = </span><span class="hl-3">&#39;0xd2a4cff31913016155e38e474a2c06d08be276cf&#39;</span><span class="hl-0">; </span><span class="hl-10">// GAS token</span><br/><span class="hl-7">const</span><span class="hl-0"> </span><span class="hl-8">methodName</span><span class="hl-0"> = </span><span class="hl-3">&#39;transfer&#39;</span><span class="hl-0">;</span><br/><br/><span class="hl-7">const</span><span class="hl-0"> </span><span class="hl-8">senderAddress</span><span class="hl-0"> = </span><span class="hl-2">WcSdk</span><span class="hl-0">.</span><span class="hl-9">getAccountAddress</span><span class="hl-0">(</span><span class="hl-2">session</span><span class="hl-0">)</span><br/><br/><span class="hl-7">const</span><span class="hl-0"> </span><span class="hl-8">from</span><span class="hl-0"> = {</span><span class="hl-2">type:</span><span class="hl-0"> </span><span class="hl-3">&#39;Address&#39;</span><span class="hl-0">, </span><span class="hl-2">value:</span><span class="hl-0"> </span><span class="hl-2">senderAddress</span><span class="hl-0">};</span><br/><span class="hl-7">const</span><span class="hl-0"> </span><span class="hl-8">recipient</span><span class="hl-0"> = {</span><span class="hl-2">type:</span><span class="hl-0"> </span><span class="hl-3">&#39;Address&#39;</span><span class="hl-0">, </span><span class="hl-2">value:</span><span class="hl-0"> </span><span class="hl-3">&#39;NbnjKGMBJzJ6j5PHeYhjJDaQ5Vy5UYu4Fv&#39;</span><span class="hl-0">};</span><br/><span class="hl-7">const</span><span class="hl-0"> </span><span class="hl-8">value</span><span class="hl-0"> = {</span><span class="hl-2">type:</span><span class="hl-0"> </span><span class="hl-3">&#39;Integer&#39;</span><span class="hl-0">, </span><span class="hl-2">value:</span><span class="hl-0"> </span><span class="hl-4">100000000</span><span class="hl-0">};</span><br/><span class="hl-7">const</span><span class="hl-0"> </span><span class="hl-8">args</span><span class="hl-0"> = {</span><span class="hl-2">type:</span><span class="hl-0"> </span><span class="hl-3">&#39;Array&#39;</span><span class="hl-0">, </span><span class="hl-2">value:</span><span class="hl-0"> []}</span><br/><br/><span class="hl-7">const</span><span class="hl-0"> </span><span class="hl-8">parameters</span><span class="hl-0"> = [</span><span class="hl-2">from</span><span class="hl-0">, </span><span class="hl-2">recipient</span><span class="hl-0">, </span><span class="hl-2">value</span><span class="hl-0">, </span><span class="hl-2">args</span><span class="hl-0">];</span><br/><span class="hl-7">const</span><span class="hl-0"> </span><span class="hl-8">resp</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-2">WcSdk</span><span class="hl-0">.</span><span class="hl-9">invokeFunction</span><span class="hl-0">(</span><span class="hl-2">wcClient</span><span class="hl-0">, </span><span class="hl-2">session</span><span class="hl-0">, </span><span class="hl-2">scripthash</span><span class="hl-0">, </span><span class="hl-2">methodName</span><span class="hl-0">, </span><span class="hl-2">parameters</span><span class="hl-0">);</span>
</code></pre>

<a href="#calling-testinvoke-will-not-require-user-acceptance" id="calling-testinvoke-will-not-require-user-acceptance" style="color: inherit; text-decoration: none;">
  <h3>Calling TestInvoke will not require user acceptance</h3>
</a>
<p>To retrieve information from a SmartContract without persisting any information on the blockchain you can use <code>WcSdk.sendRequest</code> with <code>testInvoke</code> as method, but WcSdk
has a shortcut: <code>walletConnectCtx.testInvoke</code>.</p>
<p>On the example below we are invoking the <code>balanceOf</code> method of the <code>GAS</code> token.</p>
<p>Is expected for the Wallets to not ask the user for authorization on testInvoke.</p>
<p>Check it out:</p>
<pre><code class="language-js"><span class="hl-7">const</span><span class="hl-0"> </span><span class="hl-8">scripthash</span><span class="hl-0"> = </span><span class="hl-3">&#39;0xd2a4cff31913016155e38e474a2c06d08be276cf&#39;</span><span class="hl-0">; </span><span class="hl-10">// GAS token</span><br/><span class="hl-7">const</span><span class="hl-0"> </span><span class="hl-8">methodName</span><span class="hl-0"> = </span><span class="hl-3">&#39;balanceOf&#39;</span><span class="hl-0">;</span><br/><br/><span class="hl-7">const</span><span class="hl-0"> </span><span class="hl-8">address</span><span class="hl-0"> = </span><span class="hl-2">WcSdk</span><span class="hl-0">.</span><span class="hl-9">getAccountAddress</span><span class="hl-0">(</span><span class="hl-2">session</span><span class="hl-0">)</span><br/><br/><span class="hl-7">const</span><span class="hl-0"> </span><span class="hl-8">from</span><span class="hl-0"> = {</span><span class="hl-2">type:</span><span class="hl-0"> </span><span class="hl-3">&#39;Address&#39;</span><span class="hl-0">, </span><span class="hl-2">value:</span><span class="hl-0"> </span><span class="hl-2">address</span><span class="hl-0">};</span><br/><br/><span class="hl-7">const</span><span class="hl-0"> </span><span class="hl-8">parameters</span><span class="hl-0"> = [</span><span class="hl-2">from</span><span class="hl-0">];</span><br/><span class="hl-7">const</span><span class="hl-0"> </span><span class="hl-8">resp</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-2">WcSdk</span><span class="hl-0">.</span><span class="hl-9">testInvoke</span><span class="hl-0">(</span><span class="hl-2">wcClient</span><span class="hl-0">, </span><span class="hl-2">session</span><span class="hl-0">, </span><span class="hl-2">scripthash</span><span class="hl-0">, </span><span class="hl-2">methodName</span><span class="hl-0">, </span><span class="hl-2">parameters</span><span class="hl-0">);</span>
</code></pre>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class="current"><a href="modules.html">Exports</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul><li class="tsd-kind-enum"><a href="enums/WitnessScope.html" class="tsd-kind-icon">Witness<wbr/>Scope</a></li><li class="tsd-kind-class"><a href="classes/WcSdk.html" class="tsd-kind-icon">Wc<wbr/>Sdk</a></li><li class="tsd-kind-interface tsd-has-type-parameter"><a href="interfaces/RpcCallResult.html" class="tsd-kind-icon">Rpc<wbr/>Call<wbr/>Result</a></li><li class="tsd-kind-interface"><a href="interfaces/WcCallbacks.html" class="tsd-kind-icon">Wc<wbr/>Callbacks</a></li><li class="tsd-kind-interface"><a href="interfaces/WcConnectOptions.html" class="tsd-kind-icon">Wc<wbr/>Connect<wbr/>Options</a></li><li class="tsd-kind-type-alias"><a href="modules.html#ContractInvocation" class="tsd-kind-icon">Contract<wbr/>Invocation</a></li><li class="tsd-kind-type-alias"><a href="modules.html#ContractInvocationMulti" class="tsd-kind-icon">Contract<wbr/>Invocation<wbr/>Multi</a></li><li class="tsd-kind-type-alias"><a href="modules.html#SignedMessage" class="tsd-kind-icon">Signed<wbr/>Message</a></li><li class="tsd-kind-type-alias"><a href="modules.html#Signer" class="tsd-kind-icon">Signer</a></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li><li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li><li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li><li class="tsd-kind-method tsd-parent-kind-interface"><span class="tsd-kind-icon">Method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-method tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static method</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="assets/main.js"></script></body></html>